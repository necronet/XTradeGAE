<!DOCTYPE html>
<html>
 <head>
    <link type="text/css" rel="stylesheet" href="/css/style.css" />

     <script type="text/javascript"
      src="http://maps.googleapis.com/maps/api/js?key=AIzaSyAgzq_UbTAt8NeWLYSCMNtTlOBtotCggJ0&sensor=false">
    </script>
    


    <script type="text/javascript">
      var map;
      var markersArray = [];
      
      function initialize() {
        var mapOptions = {
          center: new google.maps.LatLng(12.136389, -86.251389),
          zoom: 16,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };

         map = new google.maps.Map(document.getElementById("map_canvas"),
            mapOptions);

       var marker = new google.maps.Marker({
            position:map.getCenter()
        });

        google.maps.event.addListener(map,'click',function(event){
            placeMarker(event.latLng);
        });

      }

      // Removes the overlays from the map, but keeps them in the array
    function clearOverlays() {
      if (markersArray) {
        for (i in markersArray) {
          markersArray[i].setMap(null);
        }
        markersArray.length = 0;
      }
    }
      function placeMarker(location) {
        clearOverlays();
        var marker = new google.maps.Marker({
            position: location,
            map: map
        });
          document.getElementById('latitude').value=location.lat();
          document.getElementById('longitude').value=location.lng();
          map.setCenter(location);
          markersArray.push(marker);
      }


        google.maps.event.addDomListener(window, 'load', initialize);
    </script>
     
  </head>

  <body >

    <div><a href="{{ logout_url }}">Logout</a></div>

    {% for trader in traders %}
     <div>
      <span>Name: {{ trader.name|escape }}</span>
      <span>Address: <b>{{ trader.address }}</b></span>
      <span>Website: <b>{{ trader.website }}</b></span>

    </div>
    {% endfor %}

    <form action="/traders/add/" method="post">
      <div>Name: <input type='text' name="name"  /></div>
      <div>Website: <input type='text' name="website"  /></div>
      <div>Address: <textarea type='text' name="address" rows="3" cols="60" ></textarea></div>
      <div>Long: <input id="latitude" type='text' name="longitude"  /></div>
      <div>Lat: <input id="longitude" type='text' name="latitude"  /></div>
      <div><input type="submit" value="Sign Guestbook"></div>
    </form>

     <div id="map_canvas" style="width: 100%; height: 100%"></div>


  </body>
</html>